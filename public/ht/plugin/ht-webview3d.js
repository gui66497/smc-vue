!function(Z){"use strict";function x(f){var u,E,p,q,k,o,N,t=[],x=0;u=K.createDiv(),u.style.overflow="hidden";var Q=f.getView();Q.insertBefore(u,f.getCanvas()),E=e.Default.createDiv(),E.style.WebkitTransformStyle="preserve-3d",E.style.MozTransformStyle="preserve-3d",E.style.transformStyle="preserve-3d",u.appendChild(E),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(C){var s=C.style;y.addEventListener(Q,C.event,function(){u.style.pointerEvents=s})}),this.updateWebView=function(){var Q=f.getCanvas(),Z=1*Q.style.width.slice(0,-2),S=1*Q.style.height.slice(0,-2);(t[0]!==Z||t[1]!==S)&&(t[0]=Z,t[1]=S,u.style.width=Z+"px",u.style.height=S+"px",E.style.width=Z+"px",E.style.height=S+"px");var i=f._projectMatrix[5]*t[1]/2;i!==p&&(p=i,u.style.WebkitPerspective=p+"px",u.style.MozPerspective=p+"px",u.style.perspective=p+"px"),o="translateZ("+p+"px)"+Y(f._viewMatrix);var r=o+"translate("+t[0]/2+"px,"+t[1]/2+"px)";q===r||k||(E.style.WebkitTransform=r,E.style.MozTransform=r,E.style.transform=r,q=r),x++,N=!1,f.dm().each(function(r){r.isWebView&&z(r)});for(var W,l=E.children,j=[],g=0,F=l.length;F>g;g++)W=l[g],W._isHtWebView&&W._renderCookie!==x&&j.push(W);j.length&&j.forEach(function(Q){E.removeChild(Q)})};var c=new Array(16),z=function(j){var i=j.getAttach();if(i){i.parentElement!==E&&E.appendChild(i),i._renderCookie=x,N=!0;var v=j.getFinalScale3d(),O=j._prefrenceSize;O&&O[0]?O[1]||(O[1]=O[0]/v[0]*v[1]):O=[v[0],v[1]],i.style.width=O[0]+"px",i.style.height=O[1]+"px";var w=1/O[0],u=1/O[1],b=1,s=j.mat;c[0]=s[0]*w,c[1]=s[1]*w,c[2]=s[2]*w,c[3]=s[3]*w,c[4]=s[4]*u,c[5]=s[5]*u,c[6]=s[6]*u,c[7]=s[7]*u,c[8]=s[8]*b,c[9]=s[9]*b,c[10]=s[10]*b,c[11]=s[11]*b,c[12]=s[12],c[13]=s[13],c[14]=s[14],c[15]=s[15];var q=m(c,k?"translate("+t[0]/2+"px,"+t[1]/2+"px)"+o:""),X=i.$a2;X!==q&&(i.$a2=q,i.style.WebkitTransform=q,i.style.MozTransform=q,i.style.transform=q)}}}function f(A){return Math.abs(A)<1e-10?0:A}function Y(V){var J=V;return"matrix3d("+f(J[0])+","+f(-J[1])+","+f(J[2])+","+f(J[3])+","+f(J[4])+","+f(-J[5])+","+f(J[6])+","+f(J[7])+","+f(J[8])+","+f(-J[9])+","+f(J[10])+","+f(J[11])+","+f(J[12])+","+f(-J[13])+","+f(J[14])+","+f(J[15])+")"}function m(b,g){var n=b,j="matrix3d("+f(n[0])+","+f(n[1])+","+f(n[2])+","+f(n[3])+","+f(-n[4])+","+f(-n[5])+","+f(-n[6])+","+f(-n[7])+","+f(n[8])+","+f(n[9])+","+f(n[10])+","+f(n[11])+","+f(n[12])+","+f(n[13])+","+f(n[14])+","+f(n[15])+")";return"translate(-50%,-50%)"+(g||"")+j}var C="ht",e=Z[C],K=e.Default,y=K.getInternal(),z=y.superCall,v=e.graph3d.Graph3dView,H=v.prototype.validateImpl;v.prototype.validateImpl=function(){H.call(this);var R=this._webViewRenderer;R||(R=this._webViewRenderer=new x(this)),R.updateWebView()};var r=e.WebView3d=function(){var p=this;z(r,p),p.s({shape3d:"billboard","shape3d.reverse.flip":!0})},N=[1,1,1,1],l=[0,0,0,0];K.def(C+"."+"WebView3d",e.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(t,u,c){if(!t)return this.detachDOM();if("string"==typeof t){var i=document.createElement("iframe");i.src=t,t=i}var K=t.style;K.position="absolute",K.border=0,K.outline=0,K.padding=0,K.margin=0,t._isHtWebView=!0,this.setAttach(t),this._prefrenceSize=[u,c],this.s("shape3d.blend",l)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(Z){this.a("defaultBgColor",Z),this.getAttach()||this.s("shape3d.blend",Z)},getBgColor:function(){return this.a("defaultBgColor")||N}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);