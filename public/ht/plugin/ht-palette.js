!function(K,i,P){"use strict";var N="px",X="0",n="innerHTML",C="className",o=ht.Default,G=ht.Color,s=ht.Node,W="position",p="top",H="left",_=o.animate,E=o.getInternal(),V="width",X="0",B="none",l="max-height",A="font",I="background",O="border-box",k="user-select",g="box-sizing",M="overflow",Y=o.isTouchable,E=o.getInternal(),R=G.titleIconBackground,v=o.scrollBarInteractiveSize,c=/msie 9/.test(K.navigator?K.navigator.userAgent.toLowerCase():""),t=null,L=function(){return document},d=function(i){return L().createElement(i)},f=function(){return d("div")},b=function(){var o=f(),K=o.style;return K.msTouchAction=B,K.cursor="default",Y&&K.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",t),K.position="absolute",K.left=X,K.top=X,o},u=function(){return d("canvas")},J=function(){return document.body},Z=function(O,C,n){O.style.setProperty(C,n,t)},q=function(r,$){r.style.removeProperty($)},U=function(i,q,H){o.def(ht.widget[i],q,H)},j=function(L,$){L.appendChild($)},x=function(f,Q){f.removeChild(Q)},F=E.addEventListener;E.removeEventListener,E.addMethod(o,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:R,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:R}]},paletteTitleLabelColor:o.labelSelectColor,paletteTitleLabelFont:o.labelFont,paletteContentLabelFont:o.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:o.widgetTitleHeight,paletteTitleBackground:G.titleBackground,paletteTitleHoverBackground:G.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:P,paletteItemHoverBorderColor:G.highlight,paletteItemSelectBackground:G.highlight},!0);var y=".palette-item:hover{border: 1px solid "+o.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+o.paletteTitleHoverBackground+" !important}",z=document.createElement("style");Y||(z.styleSheet?z.styleSheet.cssText=y:z.appendChild(L().createTextNode(y))),L().getElementsByTagName("head")[0].appendChild(z);var T=function(l){var S=this;S.$22h=l,S.addListeners()};o.def(T,i,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var M=this;M.$36h&&J().removeChild(M.$36h),M.$23h=M.$24h=M.$25h=M.$35h=M.$36h=t},handle_touchstart:function(t){for(var E,h=this,M=h.$22h,v=t.target,z=M.sm(),r=M.dm(),Q="palette-header",k="palette-header-tool",n="palette-item",I=!1,S=!1,U=!1;v&&(v[C]||"").indexOf(Q)<0&&(v[C]||"").indexOf(n)<0;)v=v.parentNode;if(v&&v[C].indexOf(k)>=0?I=!0:v&&v[C].indexOf(Q)>=0?U=!0:v&&v[C].indexOf(n)>=0&&(S=!0),o.isLeftButton(t))if(h.$27h(t))h.$24h=o.getClientPoint(t),h.$25h=M.ty();else if(I){o.preventDefault(t),E=v.parentNode.$11h;var a=r.getDataById(E),e=a.s("tools")[v.toolIndex];e.action&&e.action.call(M)}else if(U){o.preventDefault(t),E=v.$11h;var a=r.getDataById(E);a.isExpanded()?a.setExpanded(!1):a.setExpanded(!0)}else if(S){E=v.$11h;var P=r.getDataById(E);z.ss(P),M.handleDragAndDrop&&(o.preventDefault(t),P.s("draggable")&&(M.handleDragAndDrop(t,"prepare"),h.$35h=0)),P.s("draggable")||(o.preventDefault(t),h.$24h=o.getClientPoint(t),h.$25h=M.ty())}else o.preventDefault(t),h.$24h=o.getClientPoint(t),h.$25h=M.ty();else h.$26h(t)},handle_mousedown:function(g){this.handle_touchstart(g)},handle_mousewheel:function($){this.handleScroll($,$.wheelDelta/40,$.wheelDelta!==$.wheelDeltaX)},handle_DOMMouseScroll:function(t){this.handleScroll(t,-t.detail,1)},handleScroll:function(J,h,v){var z=this.$22h;o.preventDefault(J),v&&z._41o()&&z.ty(z.ty()+20*h)},handle_mouseup:function(Q){this.handle_touchend(Q)},handle_touchend:function(S){var A=this;A.$37h(S),A.$26h(S)},handleWindowMouseUp:function(z){this.handleWindowTouchEnd(z)},handleWindowTouchEnd:function(P){var s=this;s.$37h(P),s.$26h(P)},$37h:function(H){var d=this,Y=d.$22h;2===d.$35h&&(d.$35h=3,Y.handleDragAndDrop(H,"end"))},handleWindowMouseMove:function(e){this.handleWindowTouchMove(e)},handleWindowTouchMove:function(z){var g=this,I=g.$22h,K=g.$23h,C=g.$24h,k=g.$25h,U=o.getClientPoint(z),e=I._29I,l=g.$36h;if(1===g.$35h||2===g.$35h){if(g.$35h=2,I.handleDragAndDrop(z,"between"),Y){var y=z.touches[0];z=y?y:z.changedTouches[0]}l.style.left=z.pageX-parseInt(l.width)/2+N,l.style.top=z.pageY-parseInt(l.height)/2+N}else"p"===K?I.ty(k+U.y-C.y):"v"===K&&I.ty(k+(C.y-U.y)/e.height*I._59I)},handle_mousemove:function(W){this.handle_touchmove(W)},handle_touchmove:function(U){if(!o.isDragging()&&o.isLeftButton(U)){var T=this,e=T.$22h,k=T.$27h(U);if(T.$24h){if(!T.$23h){if(o.getDistance(o.getClientPoint(U),T.$24h)<2)return;T.$23h=k?"v":"p",o.startDragging(T)}}else if(k)e._43o();else if(0===T.$35h){if(T.$35h=1,e.handleDragAndDrop(U,"begin"),Y){var t=U.touches[0];U=t?t:U.changedTouches[0]}var G=T.$36h=new Image,R=e.$10h[e.sm().ld().getId()].querySelector(".image-box"),v=parseInt(R.style.width),K=parseInt(R.style.height);G.draggable=!1,G.src=R.toDataURL(),G.width=v,G.height=K,G.style.position="absolute",G.style.left=U.pageX-v/2+N,G.style.top=U.pageY-K/2+N,J().appendChild(G),o.startDragging(T)}}},$27h:function(x){var $=this.$22h,t=$.getView(),p=t.getBoundingClientRect(),j=$._29I,G=x.clientX-p.left+t.scrollLeft;return $._41o()&&j.x+j.width-G<v}}),ht.widget.Palette=function(R){var L=this,Y=L._view=E.createView(null,L);L.$9h={},L.$10h={},L.$4h={},L._29I={x:0,y:0,width:0,height:0},L._59I=0,L.dm(R?R:new ht.DataModel),Y[C]="ht-widget-palette",L.$29h=new T(L),Z(Y,I,o.paletteContentBackground),Z(Y,M,"auto"),Z(Y,g,O),Z(Y,"-moz-"+g,O),Z(Y,"-webkit-"+k,B),Z(Y,"-moz-"+k,B),Z(Y,"-ms-"+k,B),Z(Y,k,B),Z(Y,"position","absolute"),Z(Y,"overflow","hidden"),j(Y,L._79O=b()),F(Y,"dragstart",function(t){t.dataTransfer&&(t.dataTransfer.setData("Text","nodeid:"+t.target.$11h),t.dataTransfer.effectAllowed="all",L.$29h.$26h())})},U("Palette",i,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:o.autoHideScrollBar,_scrollBarSize:o.scrollBarSize,_scrollBarColor:o.scrollBarColor,getViewRect:function(){return this._29I},ty:function(n){return n==t?this.getTranslateY():(this.setTranslateY(n),void 0)},setTranslateY:function(s){if(this.$32h==t){var U=this,S=U.$33h(s),v=U.$30h;U.$30h=S,U.fp("translateY",v,S)}},getTranslateY:function(){return this.$30h},setLayout:function(q){var L,G,F=this,r=F._layout;F._layout=q,"smallicons"===q?L=G=20:"iconsonly"===q?L=G=50:(L=70,G=50),F.setItemImageWidth(L),F.setItemImageHeight(G),F.setItemImagePadding(4),F.fp("layout",r,q)},getDataAt:function(k){for(var n=k.target;n&&n.$11h==t;)n=n.parentNode;return n&&n.$11h!=t?this.getDataModel().getDataById(n.$11h):void 0},$20h:function(){var w=16;return Y&&(w*=1.2),w},$19h:function(){return o.paletteTitleHeight},$18h:function(){var H=o.paletteSeparatorWidth,e=o.paletteTitleBackground,F=o.paletteSeparatorColor||o.brighter(e);return H+N+" solid "+F},$17h:function(j){Z(j,"cursor","pointer"),Z(j,"display","inline-block"),Z(j,"margin-right",(Y?8:4)+N),Z(j,"vertical-align",p)},$1h:function(l){var k=this,b=f(),P=f(),s=d("span");b[C]="palette-header",Z(b,W,"relative"),Z(b,I,o.paletteTitleBackground),Z(b,"color",o.paletteTitleLabelColor),Z(b,p,X),Z(b,g,O),Z(b,"-moz-"+g,O),Z(b,"padding","0 5px 0 0"),Z(b,"border-top",k.$18h()),Z(b,V,"100%"),Z(b,"cursor","pointer"),Z(b,"white-space","nowrap"),Z(b,M,"hidden"),Z(b,A,o.paletteTitleLabelFont),Z(b,"line-height",k.$19h()+N),b.$11h=l.getId();var q=u(),L=k.$19h(),h=k.$20h();k.$17h(q),E.setCanvas(q,h,L),j(b,q);var a=l.s("tools");if(a)for(var R=0;R<a.length;R++){var y=u();k.$17h(y),E.setCanvas(y,h,L),y[C]="palette-header-tool palette-header-tool"+l.getId()+"-"+R,y.style.position="absolute",y.style.right=(h+10)*R+"px",y.toolIndex=R,j(b,y)}return q[C]="palette-toggle-icon-"+l.getId(),P[C]="palette-content",Z(P,"max-height",0+N),Z(P,A,o.paletteContentLabelFont),Z(P,M,"hidden"),P.$11h=l.getId(),k.$9h[l.getId()]=P,s[n]=l.getName(),Z(s,A,o.paletteTitleLabelFont),j(b,q),j(b,s),[b,P]},$2h:function($){var W=this,K=W._layout,g=c&&$.s("draggable")?d("a"):f(),U=u(),G=f(),D=$.getName()||"",b=$.s("title")||$.getToolTip()||D,e=W._itemMargin;U[C]="image-box";var F=W.getItemImageWidth(),Q=W.getItemImageHeight();return E.setCanvas(U,F,Q),j(g,U),G[n]=D,G[C]="label-box","iconsonly"!==K&&j(g,G),g[C]="palette-item",Z(g,"vertical-align",p),Z(g,"cursor","pointer"),Z(g,"border-radius",5+N),Z(g,"border","1px solid transparent"),Z(g,"text-align","center"),Z(g,"display","inline-block"),Z(g,"margin-left",e+N),Z(g,"margin-top",e+N),Z(g,"color",o.paletteContentLabelColor),"smallicons"===K?(Z(U,"vertical-align","middle"),Z(g,"margin-left",2+N),Z(g,"margin-top",2+N),Z(g,"padding",2+N),Z(g,"text-align",H),Z(G,"display","inline-block"),Z(G,"min-width",W.$21h+W._itemMargin+N)):"largeicons"===K&&(Z(G,"max-width",F+N),Z(G,"overflow","hidden")),g.$11h=$.getId(),b&&(g.title=b),$.s("draggable")&&!W.handleDragAndDrop&&(c?(g.href="#",Z(g,"text-decoration",B)):g.draggable="true"),g},$16h:function(U,H,e,c){var i=E.initContext(U);E.translateAndScale(i,0,0,1),i.clearRect(0,0,e,e);var Q=(e-c)/2;o.drawStretchImage(i,o.getImage(H),"fill",0,Q,c,c),i.restore()},$15h:function(i){var U=this,Y=i.getId(),q=U._view.querySelector(".palette-toggle-icon-"+Y),K=i.isExpanded()?o.paletteCollapseIcon:o.paletteExpandIcon;if(q&&K){var s=U.$19h(),Q=U.$20h();U.$16h(q,K,s,Q)}},_drawToolsIcon:function(y){var U=this,f=y.s("tools");if(f)for(var S=0;S<f.length;S++){var _=U._view.querySelector(".palette-header-tool"+y.getId()+"-"+S),x=f[S].icon,n=U.$19h(),N=U.$20h();U.$16h(_,x,n,N)}},$14h:function(X){var e=this,L=X.getId(),s=e.$10h[L].querySelector(".image-box"),g=X.getImage(),x=X.s("image.stretch");if(s&&g){var F=E.initContext(s),T=e.getItemImagePadding();T="smallicons"===e._layout?T/2:T;var q=e.getItemImageWidth()-2*T,$=e.getItemImageHeight()-2*T;E.translateAndScale(F,0,0,1),F.clearRect(0,0,q,$),o.drawStretchImage(F,o.getImage(g),x,T,T,q,$,X,e),F.restore()}},validateImpl:function(){var w,k,h,G=this,O=G.$9h,g=G._layout,b=G.$10h,Q=G.$4h,y=G._view,E=G.dm();if(G.$13h&&(delete G.$13h,Q={},E.each(function(l){Q[l.getId()]=l})),"smallicons"===g)for(var u in Q){var Y=Q[u];if(Y instanceof s){var K=Y.getName()||"",T=o.getTextSize(o.paletteContentLabelFont,K).width;G.$21h!=t&&G.$21h>T||(G.$21h=T)}}for(var u in Q){h=Q[u];var f,c;if(E.contains(h)){if(h instanceof ht.Group){var i,W=G.$1h(h),J=b[h.getId()];J&&(i=J.nextSibling,x(y,i),x(y,J)),k=E.getSiblings(h).indexOf(h);var m=y.children[2*k]||G._79O;m&&m.parentNode?(y.insertBefore(W[0],m),y.insertBefore(i||W[1],m)):(y.appendChild(W[0]),y.appendChild(i||W[1])),b[h.getId()]=W[0],w=O[h.getId()]=i||W[1],c=h.$12h;var v=h.s("promptText");c||(h.$12h=d("div"),h.$12h[n]=v||"",c=h.$12h),0===h.getChildren().size()?w.contains(c)||j(w,c):w.contains(c)&&x(w,c)}else if(f=h.getParent()){var $=G.$2h(h),z=b[h.getId()];w=O[f.getId()],z&&x(z.parentNode,z),k=E.getSiblings(h).indexOf(h);var r=w.children[k];r?w.insertBefore($,r):j(w,$),b[h.getId()]=$,G.$14h(h)}}else{var F=b[h.getId()],A=F.parentNode;if(h instanceof ht.Group){var Z=F.nextSibling;x(y,F),x(y,Z),delete O[h.getId()]}else x(A,F),0===A.children.length&&(f=E.getDataById(A.$11h),f&&(c=f.$12h,c&&!A.contains(c)&&j(A,c)));delete b[h.getId()]}}G.$4h={};var S=function(){var z=G._59I,i=0;G.$32h!=t&&(clearInterval(G.$32h),i=0,delete G.$32h),G.$32h=setInterval(function(){G.$31h(),z===G._59I?(i++,i>=2&&(clearInterval(G.$32h),delete G.$32h)):(i=0,z=G._59I)},30)};for(var I in O)if(w=O[I],h=E.getDataById(O[I].$11h),G.$15h(h),G._drawToolsIcon(h),h.isExpanded()){if(w.style.maxHeight===0+N){var M=w.scrollHeight+G._itemMargin+N;_(w).duration(200).set(l,M).set("padding-bottom",G._itemMargin+N).end(function(){return function(){S()}}(M))}else w.style.maxHeight=w.scrollHeight+N;w.style.paddingBottom=G._itemMargin+N}else w.style.maxHeight!==0+N&&_(w).duration(200).set(l,X).set("padding-bottom",X).end(function(){return function(){S()}}(w));G.$28h(),G.$31h()},$31h:function(){for(var L=this,c=L._view,u=0,E=c.children,Q=0;Q<E.length;Q++){var s=E[Q];s.className&&s.className.indexOf("palette-")>=0&&(u+=s.offsetHeight)}L._59I=u,L.$30h=L.$33h(L.ty());var g=L.ty();c.scrollTop=-g,L._29I={x:0,y:-g,width:c.clientWidth,height:c.clientHeight},Z(L._79O,p,-g+N),L._93I()},$33h:function(I){var f=this,W=f._29I.height-f._59I;return W>I&&(I=W),I>0?0:Math.round(I)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(q){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(q.property)<0&&this.redraw(),"translateY"===q.property&&(this.iv(),this._43o())},findDataByName:function(f){for(var e=this.dm().getDatas(),T=0;T<e.size();T++){var j=e.get(T);if(j.getName()===f)return j}},setDataModel:function(R){var l=this,m=l._dataModel,h=l._selectionModel;m!==R&&(m&&(m.umm(l.$6h,l),m.umd(l.$8h,l),m.umh(l.$7h,l),h||m.sm().ums(l.$28h,l)),l._dataModel=R,R.mm(l.$6h,l),R.md(l.$8h,l),R.mh(l.$7h,l),h?h._21I(R):R.sm().ms(l.$28h,l),l.sm().setSelectionMode("single"),l.fp("dataModel",m,R))},$6h:function(t){var p=this,d=p._view,q=t.data,L=p.$4h;"add"===t.kind?L[q.getId()]=q:"remove"===t.kind?L[q.getId()]=q:"clear"===t.kind&&(p.$10h={},p.$9h={},p.$4h={},d[n]=""),p.iv()},$7h:function(N){var H=this,x=N.data;H.$4h[x.getId()]=x,H.iv()},$8h:function(L){var $=this,S=L.data,B=L.property;"expanded"===B?$.iv():($.$4h[S.getId()]=S,$.iv())},$28h:function(){var e,f=this,x=f.sm(),y="palette-item",D=x.ld();this.dm().each(function(A){e=f.$10h[A.getId()],e&&e[C].indexOf(y)>=0&&(A===D?Z(e,I,o.paletteItemSelectBackground):q(e,I))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);