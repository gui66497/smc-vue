!function(H){"use strict";var f="ht",Z=H[f],R=function(){return document},C=function(){return R().body},M=function(p,c,L){p.style.setProperty(c,L,null)},F=function(I){return R().createElement(I)},x=function(){return F("div")},W=function(){var S=F("canvas");return S},j=function(F,s){M(F,"-webkit-transform",s),M(F,"-ms-transform",s),M(F,"transform",s)},p=function(C,e){M(C,"-webkit-transform-origin",e),M(C,"-ms-transform-origin",e),M(C,"transform-origin",e)},B=function(S,G){S.appendChild(G)},k=function(M,E){M.removeChild(E)},y=H.parseInt,s=Z.Default,N=s.getInternal(),n=N.addEventListener,z=(N.removeEventListener,Math.PI),J="white-space",S="visibility",b="left",D="top",O="width",v="height",a="position",h="display",K="z-index",l="px",e="0 0",G="absolute",g="visible",T="hidden",q="none",m="block",P="nowrap",L="rgba(0, 0, 0, 0.005)";s.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var w=Z.graph.GraphView.prototype,U=w._42;w.adjustHtmlNodeIndex=!0,w._42=function(G,t){if(U.call(this,G,t),this.adjustHtmlNodeIndex)for(var s=this.getDataModel()._datas._as,L=s.length,J=1,n=0;L>n;n++){var B=s[n];if(B instanceof $){var r=this.getDataUI(B);M(r.$2f,K,J+""),M(r.$3f,K,J+1+""),J+=2}}};var X=Z.HtmlNodeUI=function(u,H){var Q=this;X.superClass.constructor.call(Q,u,H);var o=Q.$2f=x(),r=Q.$3f=W();M(o,a,G),M(o,S,T),M(o,J,P),r.draggable=!1,M(r,a,G),M(r,h,q),p(r,e),n(o,"change",function(k){var b=k.target,$=b.bind||b.getAttribute("bind"),Z=b.type&&"checkbox"===b.type?b.checked:b.value,v=H.getContext();$&&v&&(v[$]=Z,Q.$4f=JSON.stringify(v))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(q){n(o,q,this.$9f.bind(this))},Q)};s.def(X,N.ui().NodeUI,{_visible:!0,$11f:function(){var w=this,S=w.$3f,i=w._data,j=i.getDraggerImageWidth(),h=i.getDraggerImageHeight(),_=i.getDraggerImage(),o=N.initContext(S);o.beginPath(),N.setCanvas(S,j,h),N.translateAndScale(o,0,0,1),o.clearRect(0,0,j,h),s.drawImage(o,s.getImage(_),0,0,j,h),o.restore()},_80o:function(t){X.superClass._80o.call(this,t);var V=this,r=V._data,N=r._padding,H=2*N,i=V.$2f,Z=V.$3f,Q=V.gv,e=Q.getZoom(),w=Q.getTranslateX(),R=Q.getTranslateY(),d=Q.getView(),c=V._83o,U=r._width,s=r._height,$=c.position,W=c.rotation,P=(U-H)/r.$5f*e,Y=(s-H)/r.$6f*e,J=V._html,C=r._html,n=r.getHtmlType();if("html"===n){var F=r.getContext()||{},f=V.$4f,k=r.$10f,_=JSON.stringify(F);J&&f&&J===C&&f===_||(V.$4f=_,V._html=C,i.innerHTML=k?k(F):C)}else if(null!=n){var u=r.getHtml();"ht"===n&&(u=u.getView()),J&&J===u&&i.contains(J)||(V._html=u,i.innerHTML="",B(i,u))}if(!i.parentNode){var E=Q.$1f;if(!E){var A=x();M(A,a,G),M(A,K,"0"),E=Q.$1f=A;var p=Q._canvas.nextSibling;p?d.insertBefore(A,p):B(d,A)}B(E,i),B(E,Z),r.onContentInitialized&&r.onContentInitialized(i)}if(r._scalable){var I=r.$5f,o=r.$6f;j(i,"rotate("+180*(W/z)+"deg) scale("+P+","+Y+")"),M(i,O,""),M(i,v,""),M(i,b,($.x-I/e/2)*e+w+l),M(i,D,($.y-o/e/2)*e+R+l)}else{var jb=y(i.style.width),wn=y(i.style.height),Yo=y((U-H)*e),Iq=y((s-H)*e),Zj="100%",Me=i.children[0];M(Me,O,Zj),M(Me,v,Zj),(jb!==Yo||wn!==Iq)&&(M(i,O,Yo+l),M(i,v,Iq+l),"ht"===n&&C.invalidate()),j(i,"rotate("+180*(W/z)+"deg)"),M(i,b,($.x-Yo/e/2)*e+w+l),M(i,D,($.y-Iq/e/2)*e+R+l)}var bl=V.dragRect;Q.isMovable(r)&&Q.isSelected(r)&&bl?(t.save(),t.fillStyle=L,t.fillRect(bl.x,bl.y,bl.width,bl.height),t.restore(),M(Z,b,bl.x*e+w+l),M(Z,D,bl.y*e+R+l),j(Z,"scale("+e+","+e+")"),M(Z,h,m),V.$11f()):M(Z,h,q),M(i,S,this._visible?g:T)},dispose:function(){var A=this.gv.$1f;this.$2f.parentNode===A&&A.removeChild(this.$2f),this.$3f.parentNode===A&&A.removeChild(this.$3f)},_84o:function(c){this._visible=c,M(this.$2f,S,c?g:T),M(this.$3f,h,c?m:q)},_3O:function(){var W=this,l=W.gv,L=W._data;X.superClass._3O.call(W);var r=L.getRect();l.isEditable(L)&&(W.dragRect={x:r.x+r.width+L._padding,y:r.y+10,width:L.getDraggerImageWidth(),height:L.getDraggerImageHeight()},W._68o(W.dragRect))},rectIntersects:function(q){var c=this._79o();return Z.Default.intersection(c,q)?!0:void 0},$9f:function(y){var $=this.gv,P=this._data;$.sm().contains(P)&&y.stopPropagation()}});var $=Z.HtmlNode=function(){$.superClass.constructor.call(this)};Z.Default.def($,Z.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:Z.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(d){var m=this,R=m._html;m._html=d,"html"===m.getHtmlType()&&"Handlebars"in H&&(m.$10f=Handlebars.compile(d)),m.$13f(),m.fp("html",R,d)},setContext:function(v){var S=this,l=S._context;S._context=v,S.fp("context",l,v),S.$13f()},setScalable:function(S){var p=this,U=p._scalable;p._scalable=S,p.fp("scalable",U,S),p.$13f()},getHtmlType:function(){var p=this._html;return p?"string"==typeof p?"html":p.getView?"ht":"dom":null},$13f:function(){var h=this,b=h._html,H=h.$10f;if(b){var $=x(),D=!1,X=h.getHtmlType();if(M($,a,G),M($,J,P),M($,S,T),"html"===X?($.innerHTML=H?H(h.getContext()||{}):b,D=!0):"ht"===X?(B($,b.getView()),D=!0):"dom"===X&&(B($,b),D=!0),D){var p=2*h._padding;B(C(),$),h.$5f=$.scrollWidth,h.$6f=$.scrollHeight,h._width=h.$5f+p,h._height=h.$6f+p,h._originWidth=h._width,h._originHeight=h._height,k(C(),$)}}},getUIClass:function(){return Z.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);