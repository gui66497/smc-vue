!function(q,Q,S){"use strict";var x="ht",f=q[x],d=null,_=Math,Y=_.abs,D=_.max,m=Number.MAX_VALUE,E=f.Default,I=E.getInternal(),h=E.clone,J=I.vec3TransformMat4,k=I.appendArray,a=function(){var H=/v( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,C=/vt( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,$=/vn( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)( +[\d|\.|\+|\-|e]+)/,l=/f( +\d+)( +\d+)( +\d+)( +\d+)?/,K=/f( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))( +(\d+)\/(\d+))?/,r=/f( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))( +(\d+)\/(\d+)\/(\d+))?/,X=/f( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))( +(\d+)\/\/(\d+))?/,j=function(G,E){return E=parseInt(E),E>=0?G[E-1]:G[E+G.length]},V=function(d,i,U,T,p,I){if(d.vs){var l=j(i,T),q=j(i,p),r=j(i,I),o=U.matrix,e=d.vs;if(U.flipFace){var b=q;q=r,r=b}o?(k(e,J(h(l),o)),k(e,J(h(q),o)),k(e,J(h(r),o))):(k(e,l),k(e,q),k(e,r))}},c=function(r,G,X,F,J,T){if(r.vs){var p=j(G,F),P=j(G,J),b=j(G,T),c=X.flipY;if(X.flipFace){var M=P;P=b,b=M}r.uv.push(p[0],c?1-p[1]:p[1],P[0],c?1-P[1]:P[1],b[0],c?1-b[1]:b[1])}},u=function(u,R,T,X,g,O){if(u.vs){var D=j(R,X),a=j(R,g),U=j(R,O),P=T.normalMatrix,w=u.ns;if(T.flipFace){var W=a;a=U,U=W}P?(k(w,J(h(D),P)),k(w,J(h(a),P)),k(w,J(h(U),P))):(k(w,D),k(w,a),k(w,U))}},p=function($,k,N,A,D,h,y,q){var o=A&&A.length&&q;h[3]===S?(V($,k,D,h[0],h[1],h[2]),y&&c($,N,D,y[0],y[1],y[2]),o&&u($,A,D,q[0],q[1],q[2])):(V($,k,D,h[0],h[1],h[3]),V($,k,D,h[1],h[2],h[3]),y&&(c($,N,D,y[0],y[1],y[3]),c($,N,D,y[1],y[2],y[3])),o&&(u($,A,D,q[0],q[1],q[3]),u($,A,D,q[1],q[2],q[3])))},a=function(H,y,$,B){var z,h,R,M,v,o,S,F=m,q=m,K=m,L=-m,T=-m,d=-m;for(z in H)for(o=H[z].vs,S=o.length,h=0;S>h;h+=3)R=o[h+0],M=o[h+1],v=o[h+2],F>R&&(F=R),q>M&&(q=M),K>v&&(K=v),R>L&&(L=R),M>T&&(T=M),v>d&&(d=v);if($){var N=F+(L-F)/2,j=q+(T-q)/2,V=K+(d-K)/2;for(z in H)for(o=H[z].vs,S=o.length,h=0;S>h;h+=3)o[h+0]-=N,o[h+1]-=j,o[h+2]-=V}var w,s,u;$?(w=L-F,s=T-q,u=d-K):(w=2*D(Y(F),Y(L)),s=2*D(Y(q),Y(T)),u=2*D(Y(K),Y(d))),B.rawS3=[w,s,u];for(z in H){if(o=H[z].vs,y)for(S=o.length,h=0;S>h;h+=3)w&&(o[h+0]/=w),s&&(o[h+1]/=s),u&&(o[h+2]/=u);H[z].rawS3=B.rawS3}};return function(B,J,T){if(!B)return d;I.isString(J)&&(J=i(J)),T||(T={}),T.flipY==d&&(T.flipY=!0),(T.s3||T.r3||T.t3||T.mat)&&(T.matrix=I.createWorldMatrix(T.mat,T.s3,T.r3,T.rotationMode,T.t3));var q,Q,D,b,j,O,n=[],S=[],R=T.ignoreNormal?d:[],v=T.reverseFlipMtls,f={vs:[],uv:[],ns:R?[]:d},Y={htdefault:f},G=B.split("\n"),U=0;for(R&&T.matrix&&(T.normalMatrix=I.createNormalMatrix(T.matrix));U<G.length;U++)if(Q=G[U].trim(),0!==Q.length&&"#"!==Q.charAt(0))if(D=H.exec(Q))n.push([parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3])]);else if(D=C.exec(Q))S.push([parseFloat(D[1]),parseFloat(D[2])]);else if(R&&(D=$.exec(Q)))T.flipFace?R.push([parseFloat(-D[1]),parseFloat(-D[2]),parseFloat(-D[3])]):R.push([parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3])]);else if(D=l.exec(Q))p(f,n,S,R,T,[D[1],D[2],D[3],D[4]]);else if(D=K.exec(Q))p(f,n,S,R,T,[D[2],D[5],D[8],D[11]],[D[3],D[6],D[9],D[12]]);else if(D=r.exec(Q))p(f,n,S,R,T,[D[2],D[6],D[10],D[14]],[D[3],D[7],D[11],D[15]],[D[4],D[8],D[12],D[16]]);else if(D=X.exec(Q))p(f,n,S,R,T,[D[2],D[5],D[8],D[11]],d,[D[3],D[6],D[9],D[12]]);else if(/^usemtl /.test(Q)&&(b=Q.substring(7).trim(),!(f=Y[b]))){if(f={name:b,vs:[],uv:[],ns:R?[]:d},T.ignoreMtls&&T.ignoreMtls.indexOf(b)>=0&&delete f.vs,(T.reverseFlip||"*"===v||v&&v.indexOf(b)>=0)&&(f.reverseFlip=!0),J&&(j=J[b],j&&(T.ignoreColor||(f.color=j.kd),!T.ignoreTransparent&&j.d>0&&j.d<1&&(f.transparent=!0,f.opacity=j.d),!T.ignoreImage&&(O=j.map_kd)))){for(O=O.split(" "),q=0;q<O.length;q++)"-o"===O[q]?(f.uvOffset=[parseFloat(O[q+1]),parseFloat(O[q+2])],q+=2):"-s"===O[q]&&(f.uvScale=[parseFloat(O[q+1]),parseFloat(O[q+2])],q+=2);f.image=(T.prefix||"")+O[O.length-1]}Y[b]=f}var o=[];for(var V in Y){var W=Y[V].vs;W&&0!==W.length||o.push(V)}o.forEach(function(y){delete Y[y]}),a(Y,T.cube,T.center,T);var L=T.shape3d;if(L){var e=[];for(var b in Y){var f=Y[b];e.rawS3=f.rawS3,e.push(f)}E.setShape3dModel(L,e)}return Y}}(),i=function(q){var Y={};if(q)for(var U,V,D,F,i,$,w=q.split("\n"),e=/\s+/,o=0;o<w.length;o++)V=w[o].trim(),0!==V.length&&"#"!==V.charAt(0)&&(D=V.indexOf(" "),F=(D?V.substring(0,D):V).toLowerCase(),i=(D?V.substring(D+1):"").trim(),"newmtl"===F?Y[i]=U={name:i}:U&&("ka"===F||"kd"===F||"ks"===F?($=i.split(e,3),U[F]=[parseFloat($[0]),parseFloat($[1]),parseFloat($[2]),1]):U[F]="ns"===F||"d"===F?parseFloat(i):i));return Y};I.addMethod(E,{loadObj:function(I,G,z){z=z||{},E.xhrLoad(G?[I,G]:[I],function(m){var I,q=z.finishFunc,L=z.shape3d,s=m?a(m[0],m[1],z):null;if(s){if(L)I=E.getShape3dModel(L);else{I=[];for(var u in s){var k=s[u];I.rawS3=k.rawS3,I.push(k)}}q&&q(s,I,I.rawS3)}else q&&q(null)},z)},parseObj:function(B,A,p){return a(B,A,p)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:this,Object);