!function(l,P){"use strict";var v="position",M="absolute",U="relative",Y="px",J="left",X="right",F="top",e="bottom",V="display",i="none",c="block",Z=ht.Default,H=Z.getInternal(),N=Math.floor,$=Math.ceil,n=Math.PI,G=null,E=l.parseInt,s=function(g){return g.getContext("2d")},h=function(){return document},f=function(w){return h().createElement(w)},m=function(){return f("canvas")},y=function(I,a,m){I.style.setProperty(a,m,G)},j=function(e,k,K){Z.def(ht.widget[e],k,K)},b=function(p,P){p.appendChild(P)},Q=function(E,z){E.removeChild(z)},A=function(W,h,t,_){W.addEventListener(h,t,!!_)},o=function(g,B,D,a){g.removeEventListener(B,D,!!a)};ht.widget.RulerFrame=function(C){var R=this,k=R._view=H.createView(null,R),d=R.$1k=m(),t=R.$2k=m(),A=R.$3k=m(),N=R.$4k=m();R._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},R._topRulerConfig={visible:!0},R._rightRulerConfig={visible:!1},R._bottomRulerConfig={visible:!1},R._leftRulerConfig={visible:!0},b(k,d),b(k,A),b(k,t),b(k,N),y(k,v,U),y(k,"box-sizing","border-box"),y(k,"-moz-box-sizing","border-box"),y(d,v,M),y(t,v,M),y(A,v,M),y(N,v,M),R.$14k=function(){R.$13k=1,R.iv()},R.$15k=function(I){if(R._topRulerConfig.guideVisible||R._rightRulerConfig.guideVisible||R._bottomRulerConfig.guideVisible||R._leftRulerConfig.guideVisible||R._defaultRulerConfig.guideVisible||(R._topRulerConfig.guideTipVisible||R._rightRulerConfig.guideTipVisible||R._bottomRulerConfig.guideTipVisible||R._leftRulerConfig.guideTipVisible||R._defaultRulerConfig.guideTipVisible)&&R._component){var H=k.getBoundingClientRect();R.$16k={x:I.clientX-H.left,y:I.clientY-H.top},R.$5k()}},R.setComponent(C)},j("RulerFrame",P,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(_){var W=this,u=W._component,D=W.getView();if(D){if(W._component=_,W.fp("component",u,_),u){var E=W.getComponentView(u);Q(D,E),o(D,"mousemove",W.$15k),W.removeComponentPropertyChangeListener(u,W.$14k)}if(_){var U=W.getComponentView(_);b(D,U),y(U,v,M),A(D,"mousemove",W.$15k),W.addComponentPropertyChangeListener(_,W.$14k)}}},addComponentPropertyChangeListener:function(Z,i){Z&&Z.mp&&Z.mp(i)},removeComponentPropertyChangeListener:function(O,r){O&&O.ump&&O.ump(r)},getComponentHZoom:function(K){return K&&K.getZoom?K.getZoom():1},getComponentVZoom:function(W){return W&&W.getZoom?W.getZoom():1},getComponentViewRect:function(M){return M&&M.getViewRect?M.getViewRect():void 0},getComponentView:function(U){return U&&U.getView?U.getView():U},invalidateComponent:function(F){F&&F.iv&&F.iv()},validateComponent:function(w){w&&w.validate&&w.validate()},$7k:function(w,C,r,T,I,$,O,L,U,q,R,M){if(C.visible){var Z=this._defaultRulerConfig,D="borderStyle",x="borderColor",W="borderWidth",g="background",N=C[D]||Z[D],p=C[x]||Z[x],u=C[W]||Z[W],d=C.size!=G?C.size:Z.size,X=C[g]||Z[g],v=d+u,Y=this.$6k(u,N,p,w,r,I,v,O,L,U,q,R,M);y(w,I,"0px"),$?H.setCanvas(w,T-Y,d):H.setCanvas(w,d,T-Y),y(w,"background",X),y(w,V,c)}else y(w,V,i),y(this.getComponentView(this._component),I,"0px")},$6k:function(s,Q,Z,T,X,K,i,e,z,g,F,_,t){var m=0;return y(T,X,s+"px "+Q+" "+Z),y(this.getComponentView(this._component),K,i+Y),e?(y(T,z,g+Y),m+=g):y(T,z,"0px"),F?(y(T,_,t+Y),m+=t):y(T,_,"0px"),m},validateImpl:function(){var r=this,Z=r._component,N=r.$1k,z=r.$2k,b=r.$3k,i=r.$4k,R=r._view,V=r._defaultRulerConfig,k=r._topRulerConfig,E=r._rightRulerConfig,Y=r._bottomRulerConfig,g=r._leftRulerConfig,d=V.size;if(R&&Z){var t=k.size!=G?k.size:d,O=E.size!=G?E.size:d,Q=Y.size!=G?Y.size:d,h=g.size!=G?g.size:d;r.$7k(N,k,"border-bottom",R.offsetWidth,F,!0,g.visible,J,h,E.visible,X,O),r.$7k(z,E,"border-left",R.offsetHeight,X,!1,k.visible,F,t,Y.visible,e,Q),r.$7k(b,Y,"border-top",R.offsetWidth,e,!0,g.visible,J,h,E.visible,X,O),r.$7k(i,g,"border-right",R.offsetHeight,J,!1,k.visible,F,t,Y.visible,e,Q),r.$13k?delete r.$13k:r.invalidateComponent(Z),r.validateComponent(Z),r.$5k()}},$5k:function(){function g(c,n,u,L,M,U){if(n.visible){var r=s(c),h=n[X]||T,g=n[B]!=G?n[B]:N,I=n[e]||v,p=n[F]||E,Y=n.size!=G?n.size:D,pr=n[A]||_,aq=n[S]||m,xk=n[l]||k,Me=n[f]!=G?n[f]:q,im=n[O]!=G?n[O]:J,Tb=n[R]!=G?n[R]:t,bj=n[j]!=G?n[j]:K,Sc=n[w]!=G?n[w]:d,td=n[b]!=G?n[b]:a,vb=n[i]||If,Dd=n[C]||Vq;g&&(h=$[U]=$.$8k($[U]||h,n[o]||z,n[y]||H,L?Z:x,aq)),u.call($,r,P,V,Q,W,Y,L?Z:x,h,I,p,M,pr,xk);var qd=$.$16k;(Me||im)&&qd&&(L?$.$9k(r,qd.x,Y,vb,Dd,Me,im,Tb,bj,Sc,td):$.$10k(r,qd.y,Y,vb,Dd,Me,im,Tb,bj,Sc,td,M))}}var $=this,u=$.$1k,c=$.$2k,h=$.$3k,n=$.$4k,p=$._topRulerConfig,L=$._rightRulerConfig,U=$._bottomRulerConfig,Y=$._leftRulerConfig,M=$._defaultRulerConfig,r=$._component,I=$.getComponentViewRect(r),Z=$.getComponentHZoom(r),x=$.getComponentVZoom(r),P=I.x*Z,Q=P+I.width*Z,V=I.y*x,W=V+I.height*x,D=$._defaultRulerConfig.size,X="defaultMajorTickSpacing",o="maxPhysicalMajorTickSpacing",y="minPhysicalMajorTickSpacing",B="tickSpacingAdaptable",e="majorTickTextFont",F="majorTickTextColor",A="majorTickColor",l="minorTickColor",f="guideVisible",O="guideTipVisible",R="guideTipBorderColor",j="guideTipTextColor",w="guideTipTextFont",b="guideTipBackground",i="guideColor",C="guideWidth",S="minMajorTickSpacing",T=M[X],z=M[o],H=M[y],N=M[B],v=M[e],E=M[F],_=M[A],m=M[S],k=M[l],q=M[f],J=M[O],t=M[R],K=M[j],d=M[w],a=M[b],If=M[i],Vq=M[C];$._view&&r&&(g(u,p,$.$11k,!0,!1,"_currentTopMajorTickSpacing"),g(c,L,$.$12k,!1,!0,"_currentRightMajorTickSpacing"),g(h,U,$.$11k,!0,!0,"_currentBottomMajorTickSpacing"),g(n,Y,$.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(j,A,Z,Y,i){return Z>j*Y?j=N(A/Y/i)*i:j*Y>A&&(j=$(Z/Y/i)*i),j},getHTipText:function(z){var $=this,x=$._component,M=0,O=$._view.getBoundingClientRect();return x.lp?M=E(x.lp({clientX:z.x+O.left,clientY:z.y}).x):M-=E(this.getComponentView(x).style.left)||0,M},$9k:function(T,K,G,i,m,a,S,r,e,z,X){var h=this,F=h._component;T.save(),H.translateAndScale(T,0,0,1);var v=K-(E(this.getComponentView(F).style.left)||0),C=0;if(K=h.getHTipText(h.$16k),a&&(T.beginPath(),T.fillStyle=i,T.rect(v,C,m,G),T.fill()),S){T.beginPath(),T.textAlign="center",T.textBaseline="middle",T.font=z;var k=T.measureText(K).width+6;T.fillStyle=X,T.rect(v-k/2,C,k,G),T.fill(),T.strokeStyle=r,T.stroke(),T.beginPath(),T.fillStyle=e,T.fillText(K,v,C+G/2)}T.restore()},getVTipText:function(n){var d=this,y=d._component,h=0,Y=d._view.getBoundingClientRect();return y.lp?h=E(y.lp({clientX:n.x,clientY:n.y+Y.top}).y):h-=E(this.getComponentView(y).style.top)||0,h},formatScaleText:function(U){return Math.round(U)},$10k:function(v,y,e,i,Z,w,Y,$,r,L,j,U){var F=this,a=F._component;v.save(),H.translateAndScale(v,0,0,1);var N=e/2,C=y-(E(this.getComponentView(a).style.top)||0);if(y=F.getVTipText(F.$16k),w&&(v.beginPath(),v.fillStyle=i,v.rect(N-e/2,C,e,Z),v.fill()),Y){v.translate(N,C),v.rotate((U?90:-90)*n/180),v.translate(-N,-C),v.beginPath(),v.textAlign="center",v.textBaseline="middle",v.font=L;var g=v.measureText(y).width+6;v.fillStyle=j,v.rect(N-g/2,C-e/2,g,e),v.fill(),v.strokeStyle=$,v.stroke(),v.fillStyle=r,v.fillText(y,N,C)}v.restore()},$11k:function(U,r,J,q,s,C,Q,p,B,L,o,O,F){U.save(),J=0;var m=r,d=q,a=(m+d)/2;r=0,q=d-m,H.translateAndScale(U,0,0,1);var y=0,P=0,M=E(C/2),g=C-M,R=o?0:M,Y=p*Q,u=Y/10;r-=Y,q+=Y,U.clearRect(r,0,q-r,C),U.beginPath(),U.fillStyle=F;var K=N(a/u)*u-m;for(y=K;q>y;y+=u)U.rect(y,J+R,1,g);for(y=K;y>r;y-=u)U.rect(y,J+R,1,g);for(U.fill(),R=o?0:1,U.beginPath(),U.fillStyle=O,K=N(a/Y)*Y-m,y=K;q>y;y+=Y)U.rect(y,J+R,1,C-1);for(y=K;y>r;y-=Y)U.rect(y,J+R,1,C-1);U.fill();var $=E(/\d+px/.exec(B)[0]),V=($||10)/2;U.textBaseline="middle",R=o?C-V-2:V+2,U.beginPath(),U.fillStyle=L,U.font=B;var k=N(a/Y)*Y/Q;for(y=K,P=k;q>y;y+=Y,P+=p){var j=this.getHScaleText?this.getHScaleText(y):P;U.fillText(this.formatScaleText(j),y+2,J+R)}for(y=K,P=k;y>r;y-=Y,P-=p){var j=this.getHScaleText?this.getHScaleText(y):P;U.fillText(this.formatScaleText(j),y+2,J+R)}U.restore()},$12k:function(X,J,r,V,y,A,k,U,W,B,G,o,p){function g(S,s,x,w,P,r){P=Y.getVScaleText?Y.getVScaleText(x):P,P=Y.formatScaleText(P),X.translate(S+s,x),X.rotate(-w),X.translate(-S-s,-x),X.fillText(P,S+s+(r?2:1),x),X.translate(S+s,x),X.rotate(w),X.translate(-S-s,-x)}X.save(),J=0;var C=r,Z=y,Q=(C+Z)/2;r=0,y=Z-C,H.translateAndScale(X,0,0,1);var S=0,Y=this,z=0,i=E(A/2),L=A-i,u=G?0:i,m=U*k,I=m/10;r-=m,y+=m,X.clearRect(J,0,A,y-r),X.beginPath(),X.fillStyle=p;var a=N(Q/I)*I-C;for(S=a;y>S;S+=I)X.rect(J+u,S,L,1);for(S=a;S>r;S-=I)X.rect(J+u,S,L,1);for(X.fill(),u=G?0:1,X.beginPath(),X.fillStyle=o,a=N(Q/m)*m-C,S=a;y>S;S+=m)X.rect(J+u,S,A-1,1);for(S=a;S>r;S-=m)X.rect(J+u,S,A-1,1);X.fill();var h=E(/\d+px/.exec(W)[0]),T=(h||10)/2,O=90*n/180;X.textBaseline="middle",u=G?A-T:T+2,O=G?-O:O,X.beginPath(),X.fillStyle=B,X.font=W;var P=N(Q/m)*m/k;for(S=a,z=P;y>S;S+=m,z+=U)g(J,u,S,O,z,G);for(S=a,z=P;S>r;S-=m,z-=U)g(J,u,S,O,z,G);X.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var V=this,n=V._component,M=V._view;n&&V.removeComponentPropertyChangeListener(n,V.$14k),M&&(o(M,"mousemove",V.$15k),Q(M.parentNode,M),V._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:this,Object);