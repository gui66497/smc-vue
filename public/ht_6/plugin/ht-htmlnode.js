!function(l){"use strict";var a="ht",i=l[a],n=function(){return document},s=function(){return n().body},Z=function(H,D,h){H.style.setProperty(D,h,null)},h=function(g){return n().createElement(g)},x=function(){return h("div")},K=function(){var B=h("canvas");return B},y=function(I,A){Z(I,"-webkit-transform",A),Z(I,"-ms-transform",A),Z(I,"transform",A)},H=function(U,O){Z(U,"-webkit-transform-origin",O),Z(U,"-ms-transform-origin",O),Z(U,"transform-origin",O)},z=function(Z,l){Z.appendChild(l)},D=function(K,B){K.removeChild(B)},M=l.parseInt,U=i.Default,w=U.getInternal(),P=Math.PI,A="white-space",J="visibility",F="left",r="top",R="width",o="height",Q="position",V="display",E="z-index",q="px",O="0 0",e="absolute",f="visible",X="hidden",T="none",B="block",C="nowrap",k="rgba(0, 0, 0, 0.005)";U.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var Y=i.graph.GraphView.prototype,G=Y._42;Y.adjustHtmlNodeIndex=!0,Y._42=function(U,X){if(G.call(this,U,X),this.adjustHtmlNodeIndex)for(var k=this.getDataModel()._datas._as,y=k.length,H=1,D=0;y>D;D++){var W=k[D];if(W instanceof S){var N=this.getDataUI(W);Z(N.$2f,E,H+""),Z(N.$3f,E,H+1+""),H+=2}}};var t=i.HtmlNodeUI=function($,G){var L=this;t.superClass.constructor.call(L,$,G);var z=L.$2f=x(),p=L.$3f=K();Z(z,Q,e),Z(z,J,X),Z(z,A,C),p.draggable=!1,Z(p,Q,e),Z(p,V,T),H(p,O),z.addEventListener("change",function(b){var R=b.target,r=R.bind||R.getAttribute("bind"),$=R.type&&"checkbox"===R.type?R.checked:R.value,C=G.getContext();r&&C&&(C[r]=$,L.$4f=JSON.stringify(C))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(j){z.addEventListener(j,this.$9f.bind(this))},L)};U.def(t,w.ui().NodeUI,{_visible:!0,$11f:function(){var e=this,D=e.$3f,r=e._data,n=r.getDraggerImageWidth(),R=r.getDraggerImageHeight(),m=r.getDraggerImage(),p=w.initContext(D);p.beginPath(),w.setCanvas(D,n,R),w.translateAndScale(p,0,0,1),p.clearRect(0,0,n,R),U.drawImage(p,U.getImage(m),0,0,n,R),p.restore()},_80o:function(C){t.superClass._80o.call(this,C);var I=this,s=I._data,b=s._padding,m=2*b,D=I.$2f,i=I.$3f,w=I.gv,N=w.getZoom(),U=w.getTranslateX(),d=w.getTranslateY(),H=w.getView(),g=I._83o,u=s._width,p=s._height,Y=g.position,K=g.rotation,a=(u-m)/s.$5f*N,O=(p-m)/s.$6f*N,A=I._html,S=s._html,$=s.getHtmlType();if("html"===$){var _=s.getContext()||{},v=I.$4f,j=s.$10f,W=JSON.stringify(_);A&&v&&A===S&&v===W||(I.$4f=W,I._html=S,D.innerHTML=j?j(_):S)}else if(null!=$){var l=s.getHtml();"ht"===$&&(l=l.getView()),A&&A===l&&D.contains(A)||(I._html=l,D.innerHTML="",z(D,l))}if(!D.parentNode){var c=w.$1f;if(!c){var n=x();Z(n,Q,e),Z(n,E,"0"),c=w.$1f=n;var G=w._canvas.nextSibling;G?H.insertBefore(n,G):z(H,n)}z(c,D),z(c,i),s.onContentInitialized&&s.onContentInitialized(D)}if(s._scalable){var L=s.$5f,h=s.$6f;y(D,"rotate("+180*(K/P)+"deg) scale("+a+","+O+")"),Z(D,R,""),Z(D,o,""),Z(D,F,(Y.x-L/N/2)*N+U+q),Z(D,r,(Y.y-h/N/2)*N+d+q)}else{var Uc=M(D.style.width),Ei=M(D.style.height),zn=M((u-m)*N),dn=M((p-m)*N),Kl="100%",El=D.children[0];Z(El,R,Kl),Z(El,o,Kl),(Uc!==zn||Ei!==dn)&&(Z(D,R,zn+q),Z(D,o,dn+q),"ht"===$&&S.invalidate()),y(D,"rotate("+180*(K/P)+"deg)"),Z(D,F,(Y.x-zn/N/2)*N+U+q),Z(D,r,(Y.y-dn/N/2)*N+d+q)}var mj=I.dragRect;w.isMovable(s)&&w.isSelected(s)&&mj?(C.save(),C.fillStyle=k,C.fillRect(mj.x,mj.y,mj.width,mj.height),C.restore(),Z(i,F,mj.x*N+U+q),Z(i,r,mj.y*N+d+q),y(i,"scale("+N+","+N+")"),Z(i,V,B),I.$11f()):Z(i,V,T),Z(D,J,this._visible?f:X)},dispose:function(){var n=this.gv.$1f;this.$2f.parentNode===n&&n.removeChild(this.$2f),this.$3f.parentNode===n&&n.removeChild(this.$3f)},_84o:function(n){this._visible=n,Z(this.$2f,J,n?f:X),Z(this.$3f,V,n?B:T)},_3O:function(){var J=this,T=J.gv,I=J._data;t.superClass._3O.call(J);var c=I.getRect();T.isEditable(I)&&(J.dragRect={x:c.x+c.width+I._padding,y:c.y+10,width:I.getDraggerImageWidth(),height:I.getDraggerImageHeight()},J._68o(J.dragRect))},rectIntersects:function(O){var r=this._79o();return i.Default.intersection(r,O)?!0:void 0},$9f:function(i){var l=this.gv,g=this._data;l.sm().contains(g)&&i.stopPropagation()}});var S=i.HtmlNode=function(){S.superClass.constructor.call(this)};i.Default.def(S,i.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:i.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(Q){var y=this,P=y._html;y._html=Q,"html"===y.getHtmlType()&&"Handlebars"in l&&(y.$10f=Handlebars.compile(Q)),y.$13f(),y.fp("html",P,Q)},setContext:function(H){var g=this,X=g._context;g._context=H,g.fp("context",X,H),g.$13f()},setScalable:function(J){var j=this,o=j._scalable;j._scalable=J,j.fp("scalable",o,J),j.$13f()},getHtmlType:function(){var P=this._html;return P?"string"==typeof P?"html":P.getView?"ht":"dom":null},$13f:function(){var H=this,o=H._html,$=H.$10f;if(o){var U=x(),f=!1,P=H.getHtmlType();if(Z(U,Q,e),Z(U,A,C),Z(U,J,X),"html"===P?(U.innerHTML=$?$(H.getContext()||{}):o,f=!0):"ht"===P?(z(U,o.getView()),f=!0):"dom"===P&&(z(U,o),f=!0),f){var R=2*H._padding;z(s(),U),H.$5f=U.scrollWidth,H.$6f=U.scrollHeight,H._width=H.$5f+R,H._height=H.$6f+R,H._originWidth=H._width,H._originHeight=H._height,D(s(),U)}}},getUIClass:function(){return i.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:this,Object);